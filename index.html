<!DOCTYPE html>
<html ng-app class="no-js">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Kanb.am</title>
        <meta name="description" content="Kanbam for project management tools">
        <meta name="viewport" content="width=device-width">
        <link href='http://fonts.googleapis.com/css?family=Roboto+Condensed:300italic,400italic,700italic,400,300,700' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Paprika' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="css/bootstrap.min.css">
        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/main.css">
        <link rel="stylesheet" href="css/style.css" >
        
        <script src="js/lib/modernizr-2.6.2.min.js"></script>
    </head>
    <body ng-controller="App">
        <div class="alert alert-error">
            <button type="button" class="close" data-dismiss="alert">&times;</button>
            <h4>Error</h4>
            <span class="alert-message">This project don't have any members.</span>
        </div>
        <div class="searchBox">
            <form class="form-horizontal">
                <input type="text" placeholder="Type your keyword" class="searchValue" /><button class="btn btn-primary closeBtn" type="button"><i class="icon-remove icon-white"></i></button>
            </form>
        </div>
        <div class="main">
            <div class="project">
                <div class="project-title">{{currentProject.name}}</div>
                <div class="project-right">
                    <div class="project-title-mask"><img src="img/mask-titulo.png" /></div>
                    <div class="project-right-content">
                        <div class="project-indicator input">
                            <span class="project-indicator-label">ESTIMATED</span> <br />
                            <span class="project-indicator-value">{{currentProject.totalEstimated}}h</span>
                        </div>
                        <div class="project-indicator input">
                            <span class="project-indicator-label">EXECUTED</span> <br />
                            <span class="project-indicator-value">{{currentProject.totalSpent}}h</span>
                        </div>
                        <div class="project-indicator input {{getColorByVariation(currentProject.variation)}}">
                            <span class="project-indicator-label">VARIATION</span> <br />
                            <span class="project-indicator-value">{{formatVariation(currentProject.variation)}}%</span>
                        </div>
                        <div class="project-progress input">
                            <div class="progress">
                                <div class="project-bar project-bar-todo" style="width: {{currentProject.totalTodo}}%;">{{currentProject.totalTodo}}%</div>
                                <div class="project-bar project-bar-doing" style="width: {{currentProject.totalDoing}}%;">{{currentProject.totalDoing}}%</div>
                                <div class="project-bar project-bar-done" style="width: {{currentProject.totalDone}}%;">{{currentProject.totalDone}}%</div>
                            </div>
                        </div>
                        <div class="project-dropdown">
                            <div class="btn-group">
                                <button class="btn button dropdown-toggle btn-inverse" data-toggle="dropdown">
                                     <i class="icon-th-list icon-white"></i> PROJECTS
                                   
                                </button>
                                <ul class="project-list dropdown-menu">
                                    <li ng-repeat="project in projects" ng-switch on="project.parent">
                                        <a href="#" id="{{project.id}}" ng-switch-when="" style="padding-left:12px;font-weight:600;">{{project.name}}</a>
                                        <a href="#" id="{{project.id}}" ng-switch-default style="padding-left:22px;">{{project.name}}</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="settings-btn">
                            <button class="btn button" type="button"><i class="icon-cog icon-white"></i></button>
                        </div>
                        <div class="search-btn">
                            <button class="btn button" type="button"><i class="icon-search icon-white"></i></button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="head">
                <table>
                    <tr>
                        <th class="colStories">STORIES</th>
                        <th class="column">TODO</th>
                        <th class="column">DOING</th>
                        <th class="column">DONE</th>
                    </tr>
                </table>
            </div>
            <div class="stories">
                <table>
                    <colgroup>
                        <col class="colStories"/>
                        <col class="colTodo column"/>
                        <col class="colDoing column"/>
                        <col class="colDone column"/>
                    </colgroup>
                    <tbody>
                        <tr id="{{story.id}}" ng-repeat="story in stories">
                            <td class="labelStory">
                                <div class="labelStoryBox">
                                    {{story.name}}<br />
                                    <span class="estimatedTime">Estimated: {{formatHour(story.total_estimated, true)}}</span>
                                </div>
                            </td>
                            <td id="TODO" class="todo content">
                                <div id="post{{post.id}}" class="post-it post{{post.id}}" ng-repeat="post in story.todo">
                                    <div class="area post-it-{{formatColorPost(post.type)}}">
                                        <div class="task">#{{post.id}}</div>
                                        <div class="assigned_to">{{formatUserName(post.assigned_to_name)}}</div>
                                        <div class="name">{{post.name}}</a></div>
                                        <div class="hours">{{formatHour(post.estimated)}}</div>
                                        <div class="spent">{{formatHour(post.spent_time)}}</div>
                                    </div>
                                </div>
                            </td>
                            <td id="DOING" class="doing content">
                                <div id="post{{post.id}}" class="post-it post{{post.id}}" ng-repeat="post in story.doing">
                                    <div class="area post-it-{{formatColorPost(post.type)}}">
                                        <div class="task">#{{post.id}}</div>
                                        <div class="assigned_to">{{formatUserName(post.assigned_to_name)}}</div>
                                        <div class="name">{{post.name}}</div>
                                        <div class="hours">{{formatHour(post.estimated)}}</div>
                                        <div class="spent">{{formatHour(post.spent_time)}}</div>
                                    </div>
                                </div>
                            </td>
                            <td id="DONE" class="done content">
                                <div id="post{{post.id}}" class="post-it post{{post.id}}" ng-repeat="post in story.done">
                                    <div class="area post-it-{{formatColorPost(post.type)}}">
                                        <div class="task">#{{post.id}}</div>
                                        <div class="assigned_to">{{formatUserName(post.assigned_to_name)}}</div>
                                        <div class="name">{{post.name}}</div>
                                        <div class="hours">{{formatHour(post.estimated)}}</div>
                                        <div class="spent">{{formatHour(post.spent_time)}}</div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="popup">
                <iframe src="" width="80%" height="600"></iframe>
            </div>
            <div class="footer">
                <div class="footer-arrow">
                    <img src="img/aba.png" />
                </div>
                <div class="footer-items">
                    <div class="footer-item new-task">
                        <div class="footer-btn">
                            <button class="btn button new-task-btn"><i class="icon-check icon-white"></i> NEW TASK</button>
                        </div>
                        <div class="footer-detail task-detail">
                            <form id="new-task-form" action="">
                                <div class="task-inputs">
                                    <input class="input task-name" type="text" placeholder="Task name" name="taskName" />
                                    <i class="icon-time icon-white task-icon"></i>
                                    <input class="input task-hours" type="text" placeholder="0" />
                                </div>
                                <div class="task-hours-label">Hs</div>
                                <div class="btn-group dropup task-activity">
                                    <button class="btn button btn-label btn-inverse task-activity-label" data-toggle="dropdown">CHOOSE AN ACTIVITY</button>
                                    <button class="btn button dropdown-toggle btn-inverse" data-toggle="dropdown">
                                        <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu dropdown-up">
                                        <li ng-repeat="activity in activities"><a href="#" id="{{activity.id}}">{{activity.name}}</a></li>
                                    </ul>
                                </div>
                                <div class="btn-group dropup task-story">
                                    <button class="btn button btn-inverse task-story-label" data-toggle="dropdown">CHOOSE A STORY</button>
                                    <button class="btn button dropdown-toggle btn-inverse" data-toggle="dropdown">
                                        <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li ng-repeat="story in stories"><a href="#" id="{{story.id}}">{{story.name}}</a></li>
                                    </ul>
                                </div>
                                <div class="task-buttons">
                                    <button class="btn button task-save" type="submit">SAVE</button>
                                    <button class="btn button task-cancel" type="button">CANCEL</button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="footer-separator">
                        <img src="img/separador-barra-baixo.png" />
                    </div>
                    <div class="footer-item new-story">
                        <div class="footer-btn">
                            <button class="btn button new-story-btn"><i class="icon-file icon-white"></i> NEW STORY</button>
                        </div>
                        <div class="footer-detail story-detail">
                            <form id="new-story-form" action="">
                                <div class="task-inputs">
                                    <input id="storyName" class="input story-name" type="text" placeholder="Story name" />
                                </div>
                                <div class="task-buttons">
                                    <button class="btn button story-save" type="submit">SAVE</button>
                                    <button class="btn button story-cancel" type="button">CANCEL</button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="footer-separator">
                        <img src="img/separador-barra-baixo.png" />
                    </div>
                </div>
            </div>
            
            <div id="settingsModal" class="modal hide fade">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <span class="title">Kanb.am Settings</span>
                </div>
                <div class="modal-body">
                    <form class="form-horizontal">
                        <div class="control-group">
                            <label class="control-label" for="inputEmail">Choose a Tool:</label>
                            <div class="controls">
                                <div class="btn-group toolOptions">
                                    <button class="btn btn-label">Redmine</button>
                                    <button class="btn dropdown-toggle" data-toggle="dropdown">
                                        <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li><a href="#">Redmine</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="control-group">
                            <label class="control-label" for="redmineURI">Redmine URI:</label>
                            <div class="controls">
                                <input type="text" class="input-xlarge" id="redmineURI" placeholder="http://" value="http://localhost/"><br />
                                <span class="help-inline">Ex: http://myredmine.mydomain.com/</span>
                            </div>
                        </div>
                        <div class="control-group">
                            <label class="control-label" for="apiKey">Redmine API Key:</label>
                            <div class="controls">
                                <input type="text" class="input-xlarge" id="apiKey" placeholder="Paste your API Key here" value=""><br />
                                <span class="help-inline">Ex: 62de4539a7d9a370afad56cdf20177235ef34374</span>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
                    <button class="btn btn-primary saveSettings">Save changes</button>
                </div>
            </div>
            
            <div class="popupTaskDetail popover fade in"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title">Task Edit - #{{editTask.id}}</h3><div class="popover-content"><p>
                <form class="form-horizontal">
                    <div class="control-group">
                        <label class="control-label" for="taskNameEdit">Task Name:</label>
                        <div class="controls">
                            <input type="text" class="input-xlarge" id="taskNameEdit" placeholder="Type your task name" value="{{editTask.name}}" />
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="inputEmail">Assigned To:</label>
                        <div class="controls">
                            <div class="btn-group memberships">
                                <button class="btn btn-label"></button>
                                <button class="btn dropdown-toggle" data-toggle="dropdown">
                                    <span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu assignedToList">
                                    <li ng-repeat="member in currentProject.memberships"><a href="#" id="{{member.id}}">{{member.name}}</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="taskEstimatedHours">Estimated:</label>
                        <div class="controls">
                            <input type="text" class="input-mini hours" id="taskEstimatedHours" placeholder="0" value="{{editTask.estimated}}" />
                            <span class="help-inline">hs</span>
                        </div>
                    </div>
                    <hr />
                    
                    <div class="control-group">
                        <label class="control-label">Spent times:</label>
                        <div class="controls">
                            <table class="spentTimes table table-bordered table-striped" ng-switch on="editTask.spent_time">
                                <tr>
                                    <th class="activity">Activity</th>
                                    <th class="hours">Time</th>
                                    <th class="action"></th>
                                </tr>
                                <tr id="{{spent_time.id}}" ng-repeat="spent_time in editTask.spent_time_list" >
                                    <td>{{spent_time.activity_name}}</td>
                                    <td>{{formatHour(spent_time.hours)}}</td>
                                    <td><button id="{{spent_time.id}}" class="btn btn-mini btn-danger deleteSpentTime" type="button">Delete</button></td>
                                </tr>
                                <tr ng-switch-when="0">
                                    <td class="noActivityInserted" colspan="3">No activity inserted</td>
                                </tr>                              
                            </table>
                            
                            <div class="formLeft">
                                <div class="btn-group spentTimesActivities">
                                    <button class="btn btn-mini btn-label">Select an activity</button>
                                    <button class="btn btn-mini dropdown-toggle" data-toggle="dropdown">
                                        <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu assignedToList">
                                        <li ng-repeat="spentTimeActivity in spentTimeActivities"><a href="#" id="{{spentTimeActivity.id}}">{{spentTimeActivity.name}}</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="formLeft">
                                <input type="text" class="spentHours input-mini hours btn-mini" placeholder="0" value="{{updateTask.estimated_hours}}" />
                                <span class="help-inline">hs</span>
                            </div>
                            <div class="formLeft">
                                <button class="btnAddSpent btn btn-mini btn-primary">Add</button>
                            </div>
                            
                            <div class="errorSpentActivity">Fill the fields correctly.</div>
                        </div>
                        
                    </div>
                    
                    <hr />
                    
                    <div class="control-group">
                        <div class="footerLeft">
                            <a href="#" class="updateOther">Advanced options</a>
                        </div>
                        <div class="footerRight">
                            <button class="btn removeTask"><i class="icon-trash"></i></button>
                            <button class="btn closePopover">Close</button>
                            <button class="btn btn-primary updateTaskDetail">Save changes</button>
                        </div>
                    </div>
                </form>
            </p></div></div></div>
        </div>
        
        
        <script src="js/lib/angular.min.js"></script>
        <script data-main="js/main" src="js/lib/require.js"></script>
        <script type="text/javascript">
            function App($scope) {
            	require(['main'], function(main){
                	main.onReadyToStart($scope);
                });
                
                
        	}
        </script>
    </body>
</html>
